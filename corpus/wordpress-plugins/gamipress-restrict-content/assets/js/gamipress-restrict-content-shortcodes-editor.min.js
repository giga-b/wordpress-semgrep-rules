(function($){$('#gamipress_posts_restricted_current_user, #gamipress_posts_unlocked_current_user').on('change',function(){var target=$(this).closest('.cmb-row').next();if($(this).prop('checked')){target.slideUp().addClass('cmb2-tab-ignore')}else{if(target.closest('.cmb-tabs-wrap').length){if(target.hasClass('cmb-tab-active-item')){target.slideDown()}}else{target.slideDown()}
target.removeClass('cmb2-tab-ignore')}});$('#gamipress_restrict_content_unlock_by').on('change',function(){var prefix='.cmb2-id-gamipress-restrict-content-';var tag_prefix='#gamipress_restrict_content_wrapper .gamipress-restrict-content-pattern-tags-list #tag-';var unlock_by=$(this).val();$(prefix+'points').hide();$(prefix+'points-type').hide();$(prefix+'achievement').hide();$(prefix+'achievement-type').hide();$(prefix+'achievement-count').hide();$(prefix+'rank').hide();$(tag_prefix+'points').hide();$(tag_prefix+'points-type').hide();$(tag_prefix+'points-balance').hide();$(tag_prefix+'achievement').hide();$(tag_prefix+'achievement-type').hide();$(tag_prefix+'achievement-count').hide();$(tag_prefix+'rank').hide();switch(unlock_by){case 'expend_points':case 'points_balance':$(prefix+'points').show();$(prefix+'points-type').show();$(tag_prefix+'points').show();$(tag_prefix+'points-type').show();$(tag_prefix+'points-balance').show();break;case 'achievement':$(prefix+'achievement').show();$(tag_prefix+'achievement').show();break;case 'achievement_type':$(prefix+'achievement-type').show();$(prefix+'achievement-count').show();$(tag_prefix+'achievement-type').show();$(tag_prefix+'achievement-count').show();break;case 'all_achievement_type':$(prefix+'achievement-type').show();$(tag_prefix+'achievement-type').show();break;case 'rank':$(prefix+'rank').show();$(tag_prefix+'rank').show();break}});$('#gamipress_restrict_content_unlock_by').trigger('change');$('#gamipress_show_content_if_condition, #gamipress_hide_content_if_condition').on('change',function(){var group=($(this).attr('id')==='gamipress_show_content_if_condition'?'show':'hide');var prefix='.cmb2-id-gamipress-'+group+'-content-if-';var tag_prefix='#gamipress_'+group+'_content_if_wrapper .gamipress-restrict-content-pattern-tags-list #tag-';var condition=$(this).val();$(prefix+'points').hide();$(prefix+'points-type').hide();$(prefix+'achievement').hide();$(prefix+'achievement-type').hide();$(prefix+'achievement-count').hide();$(prefix+'rank').hide();$(tag_prefix+'points').hide();$(tag_prefix+'points-type').hide();$(tag_prefix+'points-balance').hide();$(tag_prefix+'achievement').hide();$(tag_prefix+'achievement-type').hide();$(tag_prefix+'achievement-count').hide();$(tag_prefix+'rank').hide();switch(condition){case 'points_greater':case 'points_lower':$(prefix+'points').show();$(prefix+'points-type').show();$(tag_prefix+'points').show();$(tag_prefix+'points-type').show();$(tag_prefix+'points-balance').show();break;case 'achievement':$(prefix+'achievement').show();$(tag_prefix+'achievement').show();break;case 'achievement_type':$(prefix+'achievement-type').show();$(prefix+'achievement-count').show();$(tag_prefix+'achievement-type').show();$(tag_prefix+'achievement-count').show();break;case 'all_achievement_type':$(prefix+'achievement-type').show();$(tag_prefix+'achievement-type').show();break;case 'rank':$(prefix+'rank').show();$(tag_prefix+'rank').show();break}});$('#gamipress_show_content_if_condition, #gamipress_hide_content_if_condition').trigger('change');var gamipress_restrict_content_editor;$('body').on('gamipress_construct_shortcode','#gamipress_restrict_content_wrapper, #gamipress_show_content_if_wrapper, #gamipress_hide_content_if_wrapper',function(e,args){var selected_text='';var textarea=gamipress_restrict_content_editor[0];if(window.tinymce.activeEditor)
selected_text=window.tinymce.activeEditor.selection.getContent();if(selected_text.length===0){textarea.focus();if(document.selection)
selected_text=document.selection.createRange().text;if(selected_text.length===0){var startPos=textarea.selectionStart;var endPos=textarea.selectionEnd;if(startPos!==endPos)
selected_text=textarea.value.substring(startPos,endPos)}}
args.output+=selected_text+'[/'+args.shortcode+']'});$('body').on('click','#insert_gamipress_shortcodes',function(e){gamipress_restrict_content_editor=$(this).closest('.wp-editor-wrap').find('.wp-editor-area').first()});$('body').on('gamipress_shortcode_attributes','#gamipress_restrict_content_wrapper',function(e,args){switch(args.attributes.unlock_by){case 'expend_points':case 'points_balance':delete args.attributes.achievement;delete args.attributes.achievement_type;delete args.attributes.achievement_count;delete args.attributes.rank;break;case 'achievement':delete args.attributes.points;delete args.attributes.points_type;delete args.attributes.achievement_type;delete args.attributes.achievement_count;delete args.attributes.rank;break;case 'achievement_type':delete args.attributes.points;delete args.attributes.points_type;delete args.attributes.achievement;delete args.attributes.rank;break;case 'all_achievement_type':delete args.attributes.points;delete args.attributes.points_type;delete args.attributes.achievement;delete args.attributes.achievement_count;delete args.attributes.rank;break;case 'rank':delete args.attributes.points;delete args.attributes.points_type;delete args.attributes.achievement;delete args.attributes.achievement_type;delete args.attributes.achievement_count;break}});$('body').on('gamipress_shortcode_attributes','#gamipress_show_content_if_wrapper, #gamipress_hide_content_if_wrapper',function(e,args){switch(args.attributes.condition){case 'points_greater':case 'points_lower':delete args.attributes.achievement;delete args.attributes.achievement_type;delete args.attributes.achievement_count;delete args.attributes.rank;break;case 'achievement':delete args.attributes.points;delete args.attributes.points_type;delete args.attributes.achievement_type;delete args.attributes.achievement_count;delete args.attributes.rank;break;case 'achievement_type':delete args.attributes.points;delete args.attributes.points_type;delete args.attributes.achievement;delete args.attributes.rank;break;case 'all_achievement_type':delete args.attributes.points;delete args.attributes.points_type;delete args.attributes.achievement;delete args.attributes.achievement_count;delete args.attributes.rank;break;case 'rank':delete args.attributes.points;delete args.attributes.points_type;delete args.attributes.achievement;delete args.attributes.achievement_type;delete args.attributes.achievement_count;break}})})(jQuery)