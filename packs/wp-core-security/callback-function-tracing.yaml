rules:
- id: wordpress.callback.function-definition
  message: 'Function definition detected: $FUNCTION_NAME'
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: "function $FUNCTION_NAME() {\n  ...\n}\n"
  paths:
    include:
    - '**/includes/**'
    - '**/admin/**'
    - '**/classes/**'
    - '**/src/**'
    - '**/tests/**'
  metadata:
    category: callback-tracing
    technology:
    - wordpress
    description: 'Detects standard function definitions. Used for cross-file analysis to trace callback functions and their security implementations.'
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other
- id: wordpress.callback.function-definition-params
  message: 'Function definition with parameters detected: $FUNCTION_NAME($PARAMS)'
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: "function $FUNCTION_NAME($PARAMS) {\n  ...\n}\n"
  paths:
    include:
    - '**/includes/**'
    - '**/admin/**'
    - '**/classes/**'
    - '**/src/**'
    - '**/tests/**'
  metadata:
    category: callback-tracing
    technology:
    - wordpress
    description: 'Detects function definitions with parameters. Used for cross-file analysis to trace callback functions that accept input parameters.'
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other
- id: wordpress.callback.class-method-definition
  message: 'Class method definition detected: $CLASS_NAME::$METHOD_NAME'
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: "class $CLASS_NAME {\n  ...\n  function $METHOD_NAME() {\n    ...\n  }\n  ...\n}\n"
  paths:
    include:
    - '**/includes/**'
    - '**/admin/**'
    - '**/classes/**'
    - '**/src/**'
    - '**/tests/**'
  metadata:
    category: callback-tracing
    technology:
    - wordpress
    description: 'Detects class method definitions. Used for cross-file analysis to trace object method callbacks and their security implementations.'
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other
- id: wordpress.callback.class-method-definition-params
  message: 'Class method definition with parameters detected: $CLASS_NAME::$METHOD_NAME($PARAMS)'
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: "class $CLASS_NAME {\n  ...\n  function $METHOD_NAME($PARAMS) {\n    ...\n  }\n  ...\n}\n"
  paths:
    include:
    - '**/includes/**'
    - '**/admin/**'
    - '**/classes/**'
    - '**/src/**'
    - '**/tests/**'
  metadata:
    category: callback-tracing
    technology:
    - wordpress
    description: 'Detects class method definitions with parameters. Used for cross-file analysis to trace object method callbacks that accept input parameters.'
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other
- id: wordpress.callback.public-class-method-definition
  message: 'Public class method definition detected: $CLASS_NAME::public $METHOD_NAME'
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: "class $CLASS_NAME {\n  ...\n  public function $METHOD_NAME() {\n    ...\n  }\n  ...\n}\n"
  paths:
    include:
    - '**/includes/**'
    - '**/admin/**'
    - '**/classes/**'
    - '**/src/**'
    - '**/tests/**'
  metadata:
    category: callback-tracing
    technology:
    - wordpress
    description: 'Detects public class method definitions. Used for cross-file analysis to trace public object method callbacks.'
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other
- id: wordpress.callback.private-class-method-definition
  message: 'Private class method definition detected: $CLASS_NAME::private $METHOD_NAME'
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: "class $CLASS_NAME {\n  ...\n  private function $METHOD_NAME() {\n    ...\n  }\n  ...\n}\n"
  paths:
    include:
    - '**/includes/**'
    - '**/admin/**'
    - '**/classes/**'
    - '**/src/**'
    - '**/tests/**'
  metadata:
    category: callback-tracing
    technology:
    - wordpress
    description: 'Detects private class method definitions. Used for cross-file analysis to trace private object method callbacks.'
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other
- id: wordpress.callback.protected-class-method-definition
  message: 'Protected class method definition detected: $CLASS_NAME::protected $METHOD_NAME'
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: "class $CLASS_NAME {\n  ...\n  protected function $METHOD_NAME() {\n    ...\n  }\n  ...\n}\n"
  paths:
    include:
    - '**/includes/**'
    - '**/admin/**'
    - '**/classes/**'
    - '**/src/**'
    - '**/tests/**'
  metadata:
    category: callback-tracing
    technology:
    - wordpress
    description: 'Detects protected class method definitions. Used for cross-file analysis to trace protected object method callbacks.'
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other
- id: wordpress.callback.static-class-method-definition
  message: 'Static class method definition detected: $CLASS_NAME::static $METHOD_NAME'
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: "class $CLASS_NAME {\n  ...\n  static function $METHOD_NAME() {\n    ...\n  }\n  ...\n}\n"
  paths:
    include:
    - '**/includes/**'
    - '**/admin/**'
    - '**/classes/**'
    - '**/src/**'
    - '**/tests/**'
  metadata:
    category: callback-tracing
    technology:
    - wordpress
    description: 'Detects static class method definitions. Used for cross-file analysis to trace static object method callbacks.'
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other
- id: wordpress.callback.anonymous-function-definition
  message: Anonymous function definition detected
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: "function() {\n  ...\n}\n"
  paths:
    include:
    - '**/includes/**'
    - '**/admin/**'
    - '**/classes/**'
    - '**/src/**'
    - '**/tests/**'
  metadata:
    category: callback-tracing
    technology:
    - wordpress
    description: 'Detects anonymous function definitions. Used for cross-file analysis to trace anonymous function callbacks.'
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other
- id: wordpress.callback.anonymous-function-definition-params
  message: 'Anonymous function definition with parameters detected: ($PARAMS)'
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: "function($PARAMS) {\n  ...\n}\n"
  paths:
    include:
    - '**/includes/**'
    - '**/admin/**'
    - '**/classes/**'
    - '**/src/**'
    - '**/tests/**'
  metadata:
    category: callback-tracing
    technology:
    - wordpress
    description: 'Detects anonymous function definitions with parameters. Used for cross-file analysis to trace anonymous function callbacks that accept input parameters.'
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other
- id: wordpress.callback.arrow-function-definition
  message: Arrow function definition detected
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'function($PARAMS) { return $EXPRESSION; }'
  paths:
    include:
    - '**/includes/**'
    - '**/admin/**'
    - '**/classes/**'
    - '**/src/**'
    - '**/tests/**'
  metadata:
    category: callback-tracing
    technology:
    - wordpress
    description: 'Detects arrow function definitions. Used for cross-file analysis to trace arrow function callbacks.'
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other
