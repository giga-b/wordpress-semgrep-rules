rules:
- id: wordpress.ajax.callback-function-detection
  message: 'AJAX callback function detected: $FUNCTION_NAME'
  severity: INFO
  languages:
  - php
  patterns:

  - pattern: "function $FUNCTION_NAME() {\n  ...\n}\n"
  metadata:
    category: ajax-security
    technology:
    - wordpress
    description: 'Detects WordPress AJAX callback functions. Used for cross-file analysis
      to identify

      functions that handle AJAX requests and may require security checks.

      '
    confidence: high
    cwe: CWE-285
    tags:
    - rest_ajax
    - wordpress
    - ajax
    - endpoints
    - info
    - security
    - rest-api
    vuln_class: rest_ajax
- id: wordpress.ajax.callback-function-with-params
  message: 'AJAX callback function with parameters detected: $FUNCTION_NAME'
  severity: INFO
  languages:
  - php
  patterns:

  - pattern: "function $FUNCTION_NAME($PARAMS) {\n  ...\n}\n"
  metadata:
    category: ajax-security
    technology:
    - wordpress
    description: 'Detects WordPress AJAX callback functions that accept parameters.

      These functions may process user input and require proper validation.

      '
    confidence: high
    cwe: CWE-285
    tags:
    - rest_ajax
    - wordpress
    - ajax
    - endpoints
    - info
    - security
    - rest-api
    vuln_class: rest_ajax
- id: wordpress.ajax.callback-function-array-style
  message: 'AJAX callback function (array style) detected: $FUNCTION_NAME'
  severity: INFO
  languages:
  - php
  patterns:

  - pattern: 'add_action(''wp_ajax_$ACTION'', array($OBJECT, ''$FUNCTION_NAME''));

    '
  metadata:
    category: ajax-security
    technology:
    - wordpress
    description: 'Detects WordPress AJAX callback functions registered using array
      syntax.

      Used for cross-file analysis to identify object method callbacks.

      '
    confidence: high
    cwe: CWE-285
    tags:
    - rest_ajax
    - wordpress
    - ajax
    - endpoints
    - info
    - security
    - rest-api
    vuln_class: rest_ajax
