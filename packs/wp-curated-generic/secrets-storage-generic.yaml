rules:
- id: wordpress.secrets.option-meta.sensitive-key
  languages: [php]
  message: Potential secret stored in options/meta with a sensitive key name.
  severity: ERROR
  metadata:
    category: secrets_storage
    cwe: CWE-312
    vuln_class: secrets_storage
    confidence: medium
    tags: [secrets, wordpress, options]
  patterns:
  - pattern-regex: "(?i)\\b(add_option|update_option|add_site_option|update_site_option)\\s*\\(\\s*['\"](api[_-]?key|secret|token|password|access[_-]?key|auth[_-]?token)[^'\"]*['\"]"
  - pattern-not-regex: "(?i)hash|encrypt|wp_hash|password_hash"


