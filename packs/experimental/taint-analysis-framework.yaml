rules:
- id: taint-source-user-input
  message: User input source - data from $_GET, $_POST, $_REQUEST
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: '$_GET[$KEY]'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: source
    description: User input from GET parameters
    cwe: CWE-20
    confidence: high
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-source-post-input
  message: User input source - data from $_POST
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: '$_POST[$KEY]'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: source
    description: User input from POST parameters
    cwe: CWE-20
    confidence: high
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-source-request-input
  message: User input source - data from $_REQUEST
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: '$_REQUEST[$KEY]'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: source
    description: User input from REQUEST parameters
    cwe: CWE-20
    confidence: high
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-source-cookie-input
  message: User input source - data from $_COOKIE
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: '$_COOKIE[$KEY]'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: source
    description: User input from cookies
    cwe: CWE-20
    confidence: high
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-source-server-input
  message: User input source - data from $_SERVER
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: '$_SERVER[$KEY]'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: source
    description: User input from server variables
    cwe: CWE-20
    confidence: high
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-source-file-content
  message: File content source - data from file operations
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'file_get_contents($FILE)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: source
    description: Data from file contents
    cwe: CWE-73
    confidence: high
    tags:
    - file-upload
    - wordpress
    - file_upload
    - info
    - validation
    - path-traversal
    - security
    vuln_class: file_upload

- id: taint-source-file-read
  message: File content source - data from file read operations
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'fread($HANDLE, $LENGTH)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: source
    description: Data from file read operations
    cwe: CWE-73
    confidence: high
    tags:
    - file-upload
    - wordpress
    - file_upload
    - info
    - validation
    - path-traversal
    - security
    vuln_class: file_upload

- id: taint-source-database-query
  message: Database query source - data from database operations
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: '$wpdb->get_results($QUERY)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: source
    description: Data from database queries
    cwe: CWE-89
    confidence: high
    tags:
    - sql-injection
    - wordpress
    - sqli
    - wpdb
    - info
    - database
    - security
    vuln_class: sqli

- id: taint-source-database-row
  message: Database row source - data from database rows
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: '$wpdb->get_row($QUERY)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: source
    description: Data from database rows
    cwe: CWE-89
    confidence: high
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-source-external-api
  message: External API source - data from external API calls
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'wp_remote_get($URL)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: source
    description: Data from external API calls
    cwe: CWE-918
    confidence: high
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-source-curl
  message: External API source - data from cURL operations
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'curl_exec($CH)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: source
    description: Data from cURL operations
    cwe: CWE-918
    confidence: high
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-sink-xss-echo
  message: XSS sink - tainted data in echo statement
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: 'echo $DATA;'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sink
    vulnerability: xss
    description: Tainted data in echo statement
    cwe: CWE-79
    confidence: high
    tags:
    - error
    - wordpress
    - escaping
    - xss
    - html
    - security
    vuln_class: xss

- id: taint-sink-xss-print
  message: XSS sink - tainted data in print statement
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: 'print $DATA;'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sink
    vulnerability: xss
    description: Tainted data in print statement
    cwe: CWE-79
    confidence: high
    tags:
    - error
    - wordpress
    - escaping
    - xss
    - html
    - security
    vuln_class: xss

- id: taint-sink-xss-printf
  message: XSS sink - tainted data in printf statement
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: 'printf($FORMAT, $DATA)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sink
    vulnerability: xss
    description: Tainted data in printf statement
    cwe: CWE-79
    confidence: high
    tags:
    - error
    - wordpress
    - escaping
    - xss
    - html
    - security
    vuln_class: xss

- id: taint-sink-sql-query
  message: SQL injection sink - tainted data in database query
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: '$wpdb->query($QUERY)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sink
    vulnerability: sql-injection
    description: Tainted data in database query
    cwe: CWE-89
    confidence: high
    tags:
    - error
    - sql-injection
    - wordpress
    - sqli
    - wpdb
    - database
    - security
    vuln_class: sqli

- id: taint-sink-sql-prepare
  message: SQL injection sink - tainted data in prepared statement
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: '$wpdb->prepare($QUERY, $ARGS)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sink
    vulnerability: sql-injection
    description: Tainted data in prepared statement
    cwe: CWE-89
    confidence: high
    tags:
    - error
    - sql-injection
    - wordpress
    - sqli
    - wpdb
    - database
    - security
    vuln_class: sqli

- id: taint-sink-file-include
  message: File inclusion sink - tainted data in include statement
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: 'include $FILE;'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sink
    vulnerability: file-inclusion
    description: Tainted data in include statement
    cwe: CWE-98
    confidence: high
    tags:
    - error
    - file-upload
    - wordpress
    - file_upload
    - validation
    - path-traversal
    - security
    vuln_class: file_upload

- id: taint-sink-file-require
  message: File inclusion sink - tainted data in require statement
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: 'require $FILE;'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sink
    vulnerability: file-inclusion
    description: Tainted data in require statement
    cwe: CWE-98
    confidence: high
    tags:
    - error
    - file-upload
    - wordpress
    - file_upload
    - validation
    - path-traversal
    - security
    vuln_class: file_upload

- id: taint-sink-file-get-contents
  message: File operation sink - tainted data in file_get_contents
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: 'file_get_contents($FILE)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sink
    vulnerability: file-inclusion
    description: Tainted data in file_get_contents
    cwe: CWE-73
    confidence: high
    tags:
    - error
    - file-upload
    - wordpress
    - file_upload
    - validation
    - path-traversal
    - security
    vuln_class: file_upload

- id: taint-sink-command-exec
  message: Command execution sink - tainted data in exec
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: 'exec($COMMAND)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sink
    vulnerability: command-injection
    description: Tainted data in exec command
    cwe: CWE-78
    confidence: high
    tags:
    - error
    - eval
    - wordpress
    - dynamic-execution
    - deserialization
    - security
    vuln_class: deserialization

- id: taint-sink-command-system
  message: Command execution sink - tainted data in system
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: 'system($COMMAND)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sink
    vulnerability: command-injection
    description: Tainted data in system command
    cwe: CWE-78
    confidence: high
    tags:
    - error
    - eval
    - wordpress
    - dynamic-execution
    - deserialization
    - security
    vuln_class: deserialization

- id: taint-sink-command-shell-exec
  message: Command execution sink - tainted data in shell_exec
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: 'shell_exec($COMMAND)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sink
    vulnerability: command-injection
    description: Tainted data in shell_exec command
    cwe: CWE-78
    confidence: high
    tags:
    - error
    - eval
    - wordpress
    - dynamic-execution
    - deserialization
    - security
    vuln_class: deserialization

- id: taint-sink-header-injection
  message: Header injection sink - tainted data in header function
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: 'header($HEADER)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sink
    vulnerability: header-injection
    description: Tainted data in header function
    cwe: CWE-113
    confidence: high
    tags:
    - error
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-sanitizer-wp-sanitize-text-field
  message: WordPress sanitizer - sanitize_text_field
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'sanitize_text_field($DATA)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: WordPress text field sanitization
    sanitizes:
    - xss
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-sanitizer-wp-sanitize-email
  message: WordPress sanitizer - sanitize_email
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'sanitize_email($DATA)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: WordPress email sanitization
    sanitizes:
    - xss
    - email-injection
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-sanitizer-wp-sanitize-url
  message: WordPress sanitizer - sanitize_url
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'sanitize_url($DATA)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: WordPress URL sanitization
    sanitizes:
    - xss
    - ssrf
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-sanitizer-wp-sanitize-file-name
  message: WordPress sanitizer - sanitize_file_name
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'sanitize_file_name($DATA)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: WordPress filename sanitization
    sanitizes:
    - path-traversal
    confidence: high
    cwe: CWE-434
    tags:
    - file-upload
    - wordpress
    - file_upload
    - info
    - validation
    - path-traversal
    - security
    vuln_class: file_upload

- id: taint-sanitizer-wp-esc-html
  message: WordPress sanitizer - esc_html
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'esc_html($DATA)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: WordPress HTML escaping
    sanitizes:
    - xss
    confidence: high
    cwe: CWE-79
    tags:
    - wordpress
    - info
    - escaping
    - xss
    - html
    - security
    vuln_class: xss

- id: taint-sanitizer-wp-esc-attr
  message: WordPress sanitizer - esc_attr
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'esc_attr($DATA)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: WordPress attribute escaping
    sanitizes:
    - xss
    confidence: high
    cwe: CWE-79
    tags:
    - wordpress
    - info
    - escaping
    - xss
    - html
    - security
    vuln_class: xss

- id: taint-sanitizer-wp-esc-js
  message: WordPress sanitizer - esc_js
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'esc_js($DATA)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: WordPress JavaScript escaping
    sanitizes:
    - xss
    confidence: high
    cwe: CWE-79
    tags:
    - wordpress
    - info
    - escaping
    - xss
    - html
    - security
    vuln_class: xss

- id: taint-sanitizer-wp-esc-sql
  message: WordPress sanitizer - esc_sql
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'esc_sql($DATA)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: WordPress SQL escaping
    sanitizes:
    - sql-injection
    confidence: high
    cwe: CWE-89
    tags:
    - sql-injection
    - wordpress
    - sqli
    - wpdb
    - info
    - database
    - security
    vuln_class: sqli

- id: taint-sanitizer-type-cast-int
  message: Type casting sanitizer - integer casting
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: '(int)$DATA'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: Integer type casting
    sanitizes:
    - sql-injection
    - xss
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-sanitizer-type-cast-float
  message: Type casting sanitizer - float casting
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: '(float)$DATA'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: Float type casting
    sanitizes:
    - sql-injection
    - xss
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-sanitizer-type-cast-string
  message: Type casting sanitizer - string casting
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: '(string)$DATA'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: String type casting
    sanitizes:
    - sql-injection
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-sanitizer-type-cast-array
  message: Type casting sanitizer - array casting
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: '(array)$DATA'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: Array type casting
    sanitizes:
    - sql-injection
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-sanitizer-is-numeric
  message: Validation sanitizer - is_numeric check
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'is_numeric($DATA)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: Numeric validation
    sanitizes:
    - sql-injection
    - xss
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-sanitizer-is-email
  message: Validation sanitizer - is_email check
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'is_email($DATA)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: Email validation
    sanitizes:
    - email-injection
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-sanitizer-is-url
  message: Validation sanitizer - is_url check
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'is_url($DATA)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: sanitizer
    description: URL validation
    sanitizes:
    - ssrf
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-flow-xss-user-to-output
  message: XSS vulnerability - tainted user input flows to output
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: |
      $user_input = $_GET[$KEY];
      ...
      echo $user_input;
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: flow
    vulnerability: xss
    description: Tainted user input flows to output without sanitization
    cwe: CWE-79
    confidence: high
    tags:
    - error
    - wordpress
    - escaping
    - xss
    - html
    - security
    vuln_class: xss

- id: taint-flow-sql-user-to-query
  message: SQL injection vulnerability - tainted user input flows to query
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: |
      $user_input = $_POST[$KEY];
      ...
      $wpdb->query("SELECT * FROM users WHERE id = " . $user_input);
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: flow
    vulnerability: sql-injection
    description: Tainted user input flows to SQL query without sanitization
    cwe: CWE-89
    confidence: high
    tags:
    - error
    - sql-injection
    - wordpress
    - sqli
    - wpdb
    - database
    - security
    vuln_class: sqli

- id: taint-flow-file-user-to-include
  message: File inclusion vulnerability - tainted user input flows to include
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: |
      $user_input = $_GET[$KEY];
      ...
      include $user_input;
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: flow
    vulnerability: file-inclusion
    description: Tainted user input flows to include without sanitization
    cwe: CWE-98
    confidence: high
    tags:
    - error
    - file-upload
    - wordpress
    - file_upload
    - validation
    - path-traversal
    - security
    vuln_class: file_upload

- id: taint-flow-command-user-to-exec
  message: Command injection vulnerability - tainted user input flows to exec
  severity: ERROR
  languages:
  - php
  patterns:
  - pattern: |
      $user_input = $_POST[$KEY];
      ...
      exec($user_input);
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: flow
    vulnerability: command-injection
    description: Tainted user input flows to command execution without sanitization
    cwe: CWE-78
    confidence: high
    tags:
    - error
    - eval
    - wordpress
    - dynamic-execution
    - deserialization
    - security
    vuln_class: deserialization

- id: taint-config-sources
  message: Taint analysis sources configuration
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: '$_GET'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: configuration
    description: Taint analysis sources configuration
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-config-sinks
  message: Taint analysis sinks configuration
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'echo $VARIABLE;'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: configuration
    description: Taint analysis sinks configuration
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other

- id: taint-config-sanitizers
  message: Taint analysis sanitizers configuration
  severity: INFO
  languages:
  - php
  patterns:
  - pattern: 'sanitize_text_field($VARIABLE)'
  paths:
    include:
    - '**/*.php'
  metadata:
    category: taint-analysis
    type: configuration
    description: Taint analysis sanitizers configuration
    confidence: high
    cwe: CWE-200
    tags:
    - info
    - wordpress
    - security
    - other
    vuln_class: other
